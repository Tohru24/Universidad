CREATE VIEW SEDES_ACT AS SELECT SEDE.NOMBRE AS NOMBRE_SEDE, SEDE.DIRECCION,CIUDAD.NOMBRE FROM SEDE@isis,CIUDAD@isis WHERE SEDE.CIUDAD_ID@isis=CIUDAD.ID@isis;
SELECT COUNT(ID_CONSULTORIO) AS NUMERO_PACIENTES,SEDE.NOMBRE FROM CITA@isis,CONSULTORIO@isis,PISO@isis,SEDE@isis WHERE CITA.ID_CONSULTORIO@isis=CONSULTORIO.ID@isis AND CONSULTORIO.ID_PISO@isis=PISO.ID@isis AND PISO.ID_SEDE@isis=SEDE.ID@isis GROUP BY SEDE.NOMBRE;
CREATE VIEW SEDE AS SELECT COUNT(ID_CONSULTORIO) AS NUMERO_PACIENTES,SEDE.NOMBRE AS NOMBRE_SEDE, SEDE.DIRECCION,CIUDAD.NOMBRE FROM CITA@isis,CONSULTORIO@isis,PISO@isis,SEDE@isis,CIUDAD@isis WHERE CITA.ID_CONSULTORIO@isis=CONSULTORIO.ID@isis AND CONSULTORIO.ID_PISO@isis=PISO.ID@isis AND PISO.ID_SEDE@isis=SEDE.ID@isis AND SEDE.CIUDAD_ID@isis=CIUDAD.ID@isis GROUP BY SEDE.NOMBRE,SEDE.DIRECCION,CIUDAD.NOMBRE;
CREATE MATERIALIZED VIEW SEDES REFRESH COMPLETE ON DEMAND START WITH TO_DATE('20-03-2021 23:59', 'dd-mm-yyyy hh24:mi') NEXT TRUNC(SYSDATE +1 ) AS SELECT COUNT(ID_CONSULTORIO) AS NUMERO_PACIENTES,SEDE.NOMBRE AS NOMBRE_SEDE, SEDE.DIRECCION,CIUDAD.NOMBRE AS CIUDAD FROM CITA@isis,CONSULTORIO@isis,PISO@isis,SEDE@isis,CIUDAD@isis WHERE CITA.ID_CONSULTORIO@isis=CONSULTORIO.ID@isis AND CONSULTORIO.ID_PISO@isis=PISO.ID@isis AND PISO.ID_SEDE@isis=SEDE.ID@isis AND SEDE.CIUDAD_ID@isis=CIUDAD.ID@isis GROUP BY SEDE.NOMBRE,SEDE.DIRECCION,CIUDAD.NOMBRE;
CREATE VIEW PACIENTE AS SELECT COUNT(SEGURO) AS NUMERO_USUARIOS, SEGURO.NOMBRE AS SEGURO FROM PACIENTE@isis,SEGURO@isis WHERE PACIENTE.SEGURO@isis=SEGURO.ID@isis GROUP BY SEGURO.NOMBRE;
CREATE MATERIALIZED VIEW SEGURO BUILD COMPLETE REFRESH COMPLETE START WITH TO_DATE(SYSDATE) NEXT TRUNC(SYSDATE, 'DY') + 7 + 23 / 24 + 59 / 1440 AS SELECT COUNT(SEGURO) AS NUMERO_USUARIOS, SEGURO.NOMBRE AS SEGURO FROM PACIENTE@isis,SEGURO@isis WHERE PACIENTE.SEGURO@isis=SEGURO.ID@isis GROUP BY SEGURO.NOMBRE;
CREATE MATERIALIZED VIEW PACIENTES_2021 BUILD COMPLETE REFRESH COMPLETE ON DEMAND START WITH TO_DATE('01-01-2021 23:59', 'dd-mm-yyyy hh24:mi') NEXT (SYSDATE +1 ) AS SELECT PACIENTE.NOMBRE AS NOMBRE_PACIENTE,PACIENTE.APELLIDO AS APELLIDO_PACIENTE,CITA.FECHA_CITA,MEDICO.NOMBRE AS NOMBRE_MEDICO,MEDICO.APELLIDO AS MEDICO_APELLIDO FROM PACIENTE@isis,CITA@isis,MEDICO@isis where CITA.ID_PACIENTE=PACIENTE.ID AND CITA.ID_MEDICO=MEDICO.ID AND CITA.FECHA_CITA>TO_DATE('ENE 1,2021','MON DD,YYYY');
CREATE MATERIALIZED VIEW MEDICOS_BOGOTA BUILD DEFERRED REFRESH COMPLETE ON DEMAND START WITH TO_DATE('30-03-2021 23:59', 'dd-mm-yyyy hh24:mi') NEXT TRUNC(SYSDATE +1) AS SELECT MEDICO.NOMBRE,MEDICO.APELLIDO,ESPECIALIDAD.NOMBRE AS ESPECIALIDAD FROM MEDICO@isis,ESPECIALIDAD@isis,ESPECIALIDADXMEDICO@isis where MEDICO.ID=ESPECIALIDADXMEDICO.ID_MEDICO AND ESPECIALIDAD.ID=ESPECIALIDADXMEDICO.ID_ESPECIALIDAD AND MEDICO.CIUDAD=1;
CREATE MATERIALIZED VIEW PACIENTES_2 BUILD DEFERRED REFRESH COMPLETE ON DEMAND START WITH TO_DATE('01-01-2021 23:59', 'dd-mm-yyyy hh24:mi') NEXT TRUNC(SYSDATE +1) AS SELECT COUNT(ID_PACIENTE) AS NUMERO_CITAS,PACIENTE.NOMBRE,PACIENTE.APELLIDO FROM CITA@isis,PACIENTE@isis where CITA.ID_PACIENTE=PACIENTE.ID AND PACIENTE.CIUDAD=2 GROUP BY PACIENTE.NOMBRE,PACIENTE.APELLIDO;
CREATE MATERIALIZED VIEW PACIENTES_3 REFRESH COMPLETE ON DEMAND START WITH TO_DATE('24-03-2021 23:59', 'dd-mm-yyyy hh24:mi') NEXT TRUNC(SYSDATE +7) AS SELECT PACIENTE.NOMBRE AS NOMBRE_PACIENTE,PACIENTE.APELLIDO AS APELLIDO_PACIENTE,CIUDAD.NOMBRE AS CIUDAD FROM PACIENTE@isis,CIUDAD@isis where PACIENTE.CIUDAD=CIUDAD.ID AND PACIENTE.FECHA_NACIMIENTO<TO_DATE('MAR 26,1971','MON DD,YYYY');